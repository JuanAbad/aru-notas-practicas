<!DOCTYPE html>
<html lang="es">
<head>
<!-- 2022-01-20 Thu 13:04 -->
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Consultas SQL</title>
<meta name="author" content="Alberto Robles Gomez" />
<meta name="generator" content="Org Mode" />
<link rel="stylesheet" type="text/css" href="../../css/index.css" />
</head>
<body>
<div id="content" class="content">
<header>
<h1 class="title">Consultas SQL</h1>
</header><ol class="org-ol">
<li><p>
Titulo de las peliculas producidas despues del año 2005
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span> titulo
<span class="org-keyword">FROM</span>   peliculas
<span class="org-keyword">WHERE</span>  anno &gt; 2005
</pre>
</div></li>

<li><p>
Precio y formato de las peliculas de menos de 1 euro
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span> precio, formato
<span class="org-keyword">FROM</span>   peliculas
<span class="org-keyword">WHERE</span>  precio &lt; 1
</pre>
</div></li>

<li><p>
Titulo de las peliculas en formato DVD
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span> titulo
<span class="org-keyword">FROM</span>   peliculas
<span class="org-keyword">WHERE</span>  formato = <span class="org-string">'DVD'</span>
</pre>
</div></li>

<li><p>
Listado con los formetos de las peliculas
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span> <span class="org-keyword">DISTINCT</span> formato
<span class="org-keyword">FROM</span>   peliculas
</pre>
</div></li>

<li><p>
Cuantas peliculas se produjeron en los 3 ultimos años
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span> <span class="org-builtin">COUNT</span><span class="org-rainbow-delimiters-depth-1">(</span>*<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-keyword">FROM</span>   peliculas
<span class="org-keyword">WHERE</span>  anno &gt;= 2019
</pre>
</div></li>

<li><p>
Cuantos DVDs estan de oferta
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span> <span class="org-builtin">COUNT</span><span class="org-rainbow-delimiters-depth-1">(</span>*<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-keyword">FROM</span>   peliculas
<span class="org-keyword">WHERE</span>  oferta = <span class="org-string">'S'</span> <span class="org-keyword">AND</span> formato = <span class="org-string">'DVD'</span>
</pre>
</div></li>

<li><p>
Precio mas caro de una pelicula
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span> <span class="org-builtin">MAX</span><span class="org-rainbow-delimiters-depth-1">(</span>precio<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-keyword">FROM</span>   peliculas
</pre>
</div></li>

<li><p>
Año de la pelicula mas antigua
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span> <span class="org-builtin">MIN</span><span class="org-rainbow-delimiters-depth-1">(</span>anno<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-keyword">FROM</span>   peliculas
</pre>
</div></li>

<li><p>
Cuantas peliculas no estan en MP4
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span> <span class="org-builtin">COUNT</span><span class="org-rainbow-delimiters-depth-1">(</span>*<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-keyword">FROM</span>   peliculas
<span class="org-keyword">WHERE</span>  formato != <span class="org-string">'MP4'</span>
</pre>
</div></li>

<li><p>
Titulo de las peliculas que empiezan por 'M'
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span> titulo
<span class="org-keyword">FROM</span>   peliculas
<span class="org-keyword">WHERE</span>  titulo <span class="org-keyword">LIKE</span> <span class="org-string">'M%'</span>
</pre>
</div></li>

<li><p>
Cuantos titulos de peliculas estan formados por mas de una palabra
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span> titulo
<span class="org-keyword">FROM</span>   peliculas
<span class="org-keyword">WHERE</span>  titulo <span class="org-keyword">LIKE</span> <span class="org-string">'% %'</span>
</pre>
</div></li>

<li><p>
Cuantas peliculas se han alquilado en Febrero
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span> <span class="org-builtin">COUNT</span><span class="org-rainbow-delimiters-depth-1">(</span>*<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-keyword">FROM</span>   alquiler
<span class="org-keyword">WHERE</span>  FECHA <span class="org-keyword">LIKE</span> <span class="org-string">'__/02/%'</span>
</pre>
</div></li>

<li><p>
Codigo de los socios que no han devuelto las pelis que alquilaron
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span> c_socio
<span class="org-keyword">FROM</span>   alquiler
<span class="org-keyword">WHERE</span>  devuelta = <span class="org-string">'N'</span>
</pre>
</div></li>

<li><p>
Nombre de los socios que presublimenete son chicas
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span> nombre
<span class="org-keyword">FROM</span>   alquiler
<span class="org-keyword">WHERE</span>  nombre <span class="org-keyword">LIKE</span> <span class="org-string">'%a'</span>
</pre>
</div></li>

<li><p>
Que titulos de peliculas no estan ni en DVD ni en MP4
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span> titulo
<span class="org-keyword">FROM</span>   peliculas
<span class="org-keyword">WHERE</span>  formato != <span class="org-string">'DVD'</span>
  <span class="org-keyword">AND</span>  formato != <span class="org-string">'MP4'</span>
</pre>
</div></li>

<li><p>
Cuantas peliculas hay de matrix
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span> <span class="org-builtin">COUNT</span><span class="org-rainbow-delimiters-depth-1">(</span>*<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-keyword">FROM</span>   peliculas
<span class="org-keyword">WHERE</span>  titulo <span class="org-keyword">LIKE</span> <span class="org-string">'Matrix%'</span>
</pre>
</div></li>

<li><p>
Cuantas peliculas se alquilaron en febrero de 2002
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span> <span class="org-builtin">COUNT</span><span class="org-rainbow-delimiters-depth-1">(</span>*<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-keyword">FROM</span>   alquiler
<span class="org-keyword">WHERE</span>  fecha <span class="org-keyword">LIKE</span> <span class="org-string">'__/02/02'</span>
</pre>
</div></li>

<li><p>
Nombre de nuestros socios que presumiblemente son chicas
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span> nombre
<span class="org-keyword">FROM</span>   socios
<span class="org-keyword">WHERE</span>  nombre <span class="org-keyword">LIKE</span> <span class="org-string">'%a'</span>
</pre>
</div></li>

<li><p>
Código de los socios que en el 2005 no nos devolvieron las
peliculas alquiladas
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span> c_socio
<span class="org-keyword">FROM</span>   alquiler
<span class="org-keyword">WHERE</span>  fecha <span class="org-keyword">LIKE</span> <span class="org-string">'__/__/05'</span>
  <span class="org-keyword">AND</span>  devuelta = <span class="org-string">'N'</span>
</pre>
</div></li>

<li><p>
Precio de la película mas cara
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span> <span class="org-builtin">MAX</span><span class="org-rainbow-delimiters-depth-1">(</span>precio<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-keyword">FROM</span>   peliculas
</pre>
</div></li>

<li><p>
Nombre de paises que tienen menos de 7 letras
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span> nombre_pais
<span class="org-keyword">FROM</span>   paises
<span class="org-keyword">WHERE</span>  <span class="org-keyword">LENGTH</span><span class="org-rainbow-delimiters-depth-1">(</span>nombre_pais<span class="org-rainbow-delimiters-depth-1">)</span> &lt; 7
</pre>
</div></li>

<li><p>
Visualiza los distintos formatos de las películas
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span> <span class="org-keyword">DISTINCT</span> formato
<span class="org-keyword">FROM</span>   peliculas
</pre>
</div></li>

<li><p>
Título de las pelis que valen 2 euros o 2 euros y pico
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span> titulo
<span class="org-keyword">FROM</span>   peliculas
<span class="org-keyword">WHERE</span>  precio &gt;= 2
  <span class="org-keyword">AND</span>  precio &lt; 3
</pre>
</div></li>

<li><p>
En qué año se produjo la primera película
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span> <span class="org-builtin">MIN</span><span class="org-rainbow-delimiters-depth-1">(</span>anno<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-keyword">FROM</span>   peliculas
</pre>
</div></li>

<li><p>
Título de las películas que se han producido en los últimos 10
años
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span> titulo
<span class="org-keyword">FROM</span>   peliculas
<span class="org-keyword">WHERE</span>  anno &gt; TO_CHAR<span class="org-rainbow-delimiters-depth-1">(</span>
         ADD_MONTHS<span class="org-rainbow-delimiters-depth-2">(</span>SYSDATE, -12*10<span class="org-rainbow-delimiters-depth-2">)</span>,
         <span class="org-string">'YYYY'</span>
       <span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div></li>

<li><p>
Precio medio de los dvds
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span> <span class="org-builtin">AVG</span><span class="org-rainbow-delimiters-depth-1">(</span>precio<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-keyword">FROM</span>   peliculas
</pre>
</div></li>

<li><p>
Cuato valen todos los DVDs que tenemos
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span> <span class="org-builtin">SUM</span><span class="org-rainbow-delimiters-depth-1">(</span>precio<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-keyword">FROM</span>   peliculas
</pre>
</div></li>

<li><p>
Cuantos cines existen entre España, Francia y Portugal
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span> <span class="org-builtin">SUM</span><span class="org-rainbow-delimiters-depth-1">(</span>cines<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-keyword">FROM</span>   paises
<span class="org-keyword">WHERE</span>  nombre_pais <span class="org-keyword">in</span> <span class="org-rainbow-delimiters-depth-1">(</span> <span class="org-string">'Espa&#241;a'</span>, <span class="org-string">'Francia'</span>, <span class="org-string">'Portugal'</span> <span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div></li>

<li><p>
Cuanto valen todas las peliculas que no están ni en BR ni en MP4
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span> <span class="org-builtin">SUM</span><span class="org-rainbow-delimiters-depth-1">(</span>precio<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-keyword">FROM</span>   peliculas
<span class="org-keyword">WHERE</span>  <span class="org-keyword">NOT</span> formato = <span class="org-string">'BR'</span>
  <span class="org-keyword">AND</span>  <span class="org-keyword">NOT</span> formato = <span class="org-string">'MP4'</span>
</pre>
</div></li>

<li><p>
Precio mas caro de una pelicula en oferta
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span> <span class="org-builtin">MAX</span><span class="org-rainbow-delimiters-depth-1">(</span>precio<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-keyword">FROM</span>   peliculas
<span class="org-keyword">WHERE</span>  oferta = <span class="org-string">'S'</span>
</pre>
</div></li>

<li><p>
Cuantos socios son de Toledo
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span> <span class="org-builtin">COUNT</span><span class="org-rainbow-delimiters-depth-1">(</span>*<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-keyword">FROM</span>   socios
<span class="org-keyword">WHERE</span>  telefono <span class="org-keyword">LIKE</span> <span class="org-string">'925%'</span>
</pre>
</div></li>

<li><p>
Cual es la facturación total del 2º semestre de 2002
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span> <span class="org-builtin">SUM</span><span class="org-rainbow-delimiters-depth-1">(</span>precio<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-keyword">FROM</span>   peliculas, alquiler
<span class="org-keyword">WHERE</span>  SUBSTR<span class="org-rainbow-delimiters-depth-1">(</span>fecha, 4, 2<span class="org-rainbow-delimiters-depth-1">)</span> &gt; 6
  <span class="org-keyword">AND</span>  fecha <span class="org-keyword">LIKE</span> <span class="org-string">'__/__/02'</span>
</pre>
</div></li>

<li><p>
Que codigos de socio alquilan películas en Enero
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span> c_socio
<span class="org-keyword">FROM</span>   alquiler
<span class="org-keyword">WHERE</span>  fecha <span class="org-keyword">LIKE</span> <span class="org-string">'__/01/__'</span>
</pre>
</div></li>

<li><p>
Cuanto dinero se ha gastado el socio de código 1001
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span> <span class="org-builtin">SUM</span><span class="org-rainbow-delimiters-depth-1">(</span>precio<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-keyword">FROM</span>   alquiler, peliculas
<span class="org-keyword">WHERE</span>  c_socio = 1001
</pre>
</div></li>

<li><p>
Visualizar los paises de más de 8000 cines ordenados
alfabeticamente
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span>   nombre_pais
<span class="org-keyword">FROM</span>     paises
<span class="org-keyword">WHERE</span>    cines &gt; 8000
<span class="org-keyword">ORDER</span> <span class="org-keyword">BY</span> nombre_pais
</pre>
</div></li>

<li><p>
Cuantas veces se ha alquilado la pelicula de codigo 2
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span> <span class="org-builtin">COUNT</span><span class="org-rainbow-delimiters-depth-1">(</span>*<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-keyword">FROM</span>   alquiler
<span class="org-keyword">WHERE</span>  c_peli = 2
</pre>
</div></li>

<li><p>
Nombre de los hermanos de Gema Ramirez Lopez
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span> nombre
<span class="org-keyword">FROM</span>   socios
<span class="org-keyword">WHERE</span>  ape1 = <span class="org-string">'ramirez'</span>
  <span class="org-keyword">AND</span>  ape2 = <span class="org-string">'lopez'</span>
  <span class="org-keyword">AND</span>  <span class="org-keyword">NOT</span> nombre = <span class="org-string">'gema'</span>
</pre>
</div></li>

<li><p>
Despues del 2000 en cuantos años no se han producido peliculas
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span> SUBSTR<span class="org-rainbow-delimiters-depth-1">(</span>SYSDATE, 7, 2<span class="org-rainbow-delimiters-depth-1">)</span>
       - <span class="org-builtin">COUNT</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">DISTINCT</span> anno<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-keyword">FROM</span>   peliculas
<span class="org-keyword">WHERE</span>  anno &gt; 2000
</pre>
</div></li>

<li><p>
Visualiza en que años se han alquilado peliculas
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span> <span class="org-keyword">DISTINCT</span> SUBSTR<span class="org-rainbow-delimiters-depth-1">(</span>fecha, 7, 2<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-keyword">FROM</span>   alquiler
</pre>
</div></li>

<li><p>
Cuantas peliculas hay de Tiburon
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span> <span class="org-builtin">COUNT</span><span class="org-rainbow-delimiters-depth-1">(</span>*<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-keyword">FROM</span>   peliculas
<span class="org-keyword">WHERE</span>  titulo <span class="org-keyword">LIKE</span> <span class="org-string">'Tibur&#243;n%'</span>
</pre>
</div></li>

<li><p>
Cuantos alquileres de un solo dia no se han devuelto
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span> <span class="org-builtin">COUNT</span><span class="org-rainbow-delimiters-depth-1">(</span>*<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-keyword">FROM</span>   alquiler
<span class="org-keyword">WHERE</span>  ndias = 1
  <span class="org-keyword">AND</span>  devuelta = <span class="org-string">'N'</span>
</pre>
</div></li>

<li><p>
Cuantos socios viven en la calle oro
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span> <span class="org-builtin">COUNT</span><span class="org-rainbow-delimiters-depth-1">(</span>*<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-keyword">FROM</span>   socios
<span class="org-keyword">WHERE</span>  direccion <span class="org-keyword">LIKE</span> <span class="org-string">'oro,%'</span>
</pre>
</div></li>

<li><p>
Que titulo de peliculas es la mas cara
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span> titulo
<span class="org-keyword">FROM</span>   peliculas
<span class="org-keyword">WHERE</span>  precio = <span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">SELECT</span> <span class="org-builtin">MAX</span><span class="org-rainbow-delimiters-depth-2">(</span>precio<span class="org-rainbow-delimiters-depth-2">)</span> <span class="org-keyword">FROM</span> peliculas<span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div></li>

<li><p>
Cual es el titulo de la pelicula mas moderna
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span> titulo
<span class="org-keyword">FROM</span>   peliculas
<span class="org-keyword">WHERE</span>  anno = <span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">SELECT</span> <span class="org-builtin">MAX</span><span class="org-rainbow-delimiters-depth-2">(</span>anno<span class="org-rainbow-delimiters-depth-2">)</span> <span class="org-keyword">FROM</span> PELICULAS<span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div></li>

<li><p>
En que formato esta la pelicula mas barata
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span> <span class="org-keyword">DISTINCT</span> formato
<span class="org-keyword">FROM</span>   peliculas
<span class="org-keyword">WHERE</span>  precio = <span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">SELECT</span> <span class="org-builtin">MIN</span><span class="org-rainbow-delimiters-depth-2">(</span>precio<span class="org-rainbow-delimiters-depth-2">)</span> <span class="org-keyword">FROM</span> PELICULAS<span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div></li>

<li><p>
Cuando se hizo el ultimo alquiler
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span> <span class="org-builtin">MAX</span><span class="org-rainbow-delimiters-depth-1">(</span>fecha<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-keyword">FROM</span>   alquiler
</pre>
</div></li>

<li><p>
Cual es el pais que tiene mas cines
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span> nombre_pais
<span class="org-keyword">FROM</span>   paises
<span class="org-keyword">WHERE</span>  cines = <span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">SELECT</span> <span class="org-builtin">MAX</span><span class="org-rainbow-delimiters-depth-2">(</span>cines<span class="org-rainbow-delimiters-depth-2">)</span> <span class="org-keyword">FROM</span> paises<span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div></li>

<li><p>
Titulo de las peliculas españolas
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span> titulo
<span class="org-keyword">FROM</span>   peliculas
<span class="org-keyword">WHERE</span>  c_pais = <span class="org-rainbow-delimiters-depth-1">(</span>
         <span class="org-keyword">SELECT</span> c_pais
         <span class="org-keyword">FROM</span>   paises
         <span class="org-keyword">WHERE</span>  nombre_pais = <span class="org-string">'Espa&#241;a'</span>
       <span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div></li>

<li><p>
Titulo de las peliculas que no se alquilan
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span> titulo
<span class="org-keyword">FROM</span>   peliculas
<span class="org-keyword">WHERE</span>  c_peli <span class="org-keyword">NOT</span> <span class="org-keyword">IN</span> <span class="org-rainbow-delimiters-depth-1">(</span>
         <span class="org-keyword">SELECT</span> <span class="org-keyword">DISTINCT</span> c_peli
         <span class="org-keyword">FROM</span> alquiler
       <span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div></li>

<li><p>
Nombre de los hermanos de Laura.
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span> nombre
<span class="org-keyword">FROM</span>   socios
<span class="org-keyword">WHERE</span>  ape1 = <span class="org-rainbow-delimiters-depth-1">(</span>
         <span class="org-keyword">SELECT</span> ape1
         <span class="org-keyword">FROM</span>   socios
         <span class="org-keyword">WHERE</span>  nombre = <span class="org-string">'laura'</span>
       <span class="org-rainbow-delimiters-depth-1">)</span>
  <span class="org-keyword">AND</span>  ape2 = <span class="org-rainbow-delimiters-depth-1">(</span>
         <span class="org-keyword">SELECT</span> ape2
         <span class="org-keyword">FROM</span>   socios
         <span class="org-keyword">WHERE</span>  nombre = <span class="org-string">'laura'</span>
       <span class="org-rainbow-delimiters-depth-1">)</span>
  <span class="org-keyword">AND</span>  nombre != <span class="org-string">'laura'</span>
</pre>
</div></li>

<li><p>
Titulo de las peliculas del pais que menos cines tiene
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span> titulo
<span class="org-keyword">FROM</span>   peliculas
<span class="org-keyword">WHERE</span>  c_pais = <span class="org-rainbow-delimiters-depth-1">(</span>
         <span class="org-keyword">SELECT</span> c_pais
         <span class="org-keyword">FROM</span>   paises
         <span class="org-keyword">WHERE</span>  cines = <span class="org-rainbow-delimiters-depth-2">(</span>
           <span class="org-keyword">SELECT</span> <span class="org-builtin">MIN</span><span class="org-rainbow-delimiters-depth-3">(</span>cines<span class="org-rainbow-delimiters-depth-3">)</span>
           <span class="org-keyword">FROM</span>   paises
         <span class="org-rainbow-delimiters-depth-2">)</span>
       <span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div></li>

<li><p>
Codigo de la peliculas que se alquilo la primera vez
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span> c_peli
<span class="org-keyword">FROM</span>   alquiler
<span class="org-keyword">WHERE</span>  fecha = <span class="org-rainbow-delimiters-depth-1">(</span>
         <span class="org-keyword">SELECT</span> <span class="org-builtin">MIN</span><span class="org-rainbow-delimiters-depth-2">(</span>fecha<span class="org-rainbow-delimiters-depth-2">)</span>
         <span class="org-keyword">FROM</span>   alquiler
       <span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div></li>

<li><p>
Codigo del socio que realizo el alquiler mas barato
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span> c_socio
<span class="org-keyword">FROM</span>   alquiler
<span class="org-keyword">WHERE</span>  total = <span class="org-rainbow-delimiters-depth-1">(</span>
         <span class="org-keyword">SELECT</span> <span class="org-builtin">MIN</span><span class="org-rainbow-delimiters-depth-2">(</span>total<span class="org-rainbow-delimiters-depth-2">)</span>
         <span class="org-keyword">FROM</span>   alquiler
       <span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div></li>

<li><p>
Cuantas peliculas tenemos en los diferentes formatos
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span>   <span class="org-builtin">COUNT</span><span class="org-rainbow-delimiters-depth-1">(</span>formato<span class="org-rainbow-delimiters-depth-1">)</span>, formato
<span class="org-keyword">FROM</span>     peliculas
<span class="org-keyword">GROUP</span> <span class="org-keyword">BY</span> formato
</pre>
</div></li>

<li><p>
Listado con el numero de alquileres realizados los diferentes años
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span>   substr<span class="org-rainbow-delimiters-depth-1">(</span>fecha, 7, 2<span class="org-rainbow-delimiters-depth-1">)</span>, <span class="org-builtin">COUNT</span><span class="org-rainbow-delimiters-depth-1">(</span>*<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-keyword">FROM</span>     alquiler
<span class="org-keyword">GROUP</span> <span class="org-keyword">BY</span> substr<span class="org-rainbow-delimiters-depth-1">(</span>fecha, 7, 2<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-keyword">ORDER</span> <span class="org-keyword">BY</span> substr<span class="org-rainbow-delimiters-depth-1">(</span>fecha, 7, 2<span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div></li>

<li><p>
Listado de los precios de las peliculas mas caras en los
diferentes años
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span>   anno, <span class="org-builtin">MAX</span><span class="org-rainbow-delimiters-depth-1">(</span>precio<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-keyword">FROM</span>     peliculas
<span class="org-keyword">GROUP</span> <span class="org-keyword">BY</span> anno
<span class="org-keyword">ORDER</span> <span class="org-keyword">BY</span> anno
</pre>
</div></li>

<li><p>
Listado con el total que hemos facturada los distintos años,
alquilando peliculas
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span>   substr<span class="org-rainbow-delimiters-depth-1">(</span>fecha, 7, 2<span class="org-rainbow-delimiters-depth-1">)</span>, <span class="org-builtin">SUM</span><span class="org-rainbow-delimiters-depth-1">(</span>total<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-keyword">FROM</span>     alquiler
<span class="org-keyword">GROUP</span> <span class="org-keyword">BY</span> substr<span class="org-rainbow-delimiters-depth-1">(</span>fecha, 7, 2<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-keyword">ORDER</span> <span class="org-keyword">BY</span> substr<span class="org-rainbow-delimiters-depth-1">(</span>fecha, 7, 2<span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div></li>

<li><p>
Cuantos DVDs españoles hay?
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span> <span class="org-builtin">COUNT</span><span class="org-rainbow-delimiters-depth-1">(</span>*<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-keyword">FROM</span>   peliculas
<span class="org-keyword">WHERE</span>  formato = <span class="org-string">'DVD'</span>
  <span class="org-keyword">and</span>  c_pais = <span class="org-rainbow-delimiters-depth-1">(</span>
         <span class="org-keyword">SELECT</span> c_pais
         <span class="org-keyword">FROM</span>   paises
         <span class="org-keyword">WHERE</span>  nombre_pais = <span class="org-string">'Espa&#241;a'</span>
      <span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div></li>

<li><p>
Listado con las diferencias familias socias (1er apellido) junto
con el numero de integrantes que tiene cada familia.
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span>   ape1, <span class="org-builtin">COUNT</span><span class="org-rainbow-delimiters-depth-1">(</span>*<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-keyword">FROM</span>     socios
<span class="org-keyword">GROUP</span> <span class="org-keyword">BY</span> ape1
<span class="org-keyword">ORDER</span> <span class="org-keyword">BY</span> ape1
</pre>
</div></li>

<li><p>
Listado con los diferentes titulos de peliculas que se han ido
produciendo los diferentes años.
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span>   anno, titulo
<span class="org-keyword">FROM</span>     peliculas
<span class="org-keyword">ORDER</span> <span class="org-keyword">BY</span> anno, titulo
</pre>
</div></li>

<li><p>
Listado con el titulo de las peliculas junto con el nombre de pais
al que pertenece.
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span>   pe.titulo, pa.nombre_pais
<span class="org-keyword">FROM</span>     peliculas pe, paises pa
<span class="org-keyword">WHERE</span>    pe.c_pais = pa.c_pais
<span class="org-keyword">ORDER</span> <span class="org-keyword">BY</span> pe.titulo
</pre>
</div></li>

<li><p>
Listado con los titulos de las peliculas que se han alquildado
junto con la fecha en que se alquilo
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span>   a.fecha, p.titulo
<span class="org-keyword">FROM</span>     peliculas p, alquiler a
<span class="org-keyword">WHERE</span>    p.c_peli = a.c_peli
<span class="org-keyword">ORDER</span> <span class="org-keyword">BY</span> a.fecha
</pre>
</div></li>

<li><p>
Nombre de los socios que no han visto ninguna de Torrente.
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span>   nombre, ape1
<span class="org-keyword">FROM</span>     socios
<span class="org-keyword">WHERE</span>    c_socio <span class="org-keyword">NOT</span> <span class="org-keyword">IN</span> <span class="org-rainbow-delimiters-depth-1">(</span>
           <span class="org-keyword">SELECT</span> c_socio
           <span class="org-keyword">FROM</span>   alquiler
           <span class="org-keyword">WHERE</span>  c_peli <span class="org-keyword">IN</span> <span class="org-rainbow-delimiters-depth-2">(</span>
                    <span class="org-keyword">SELECT</span> c_peli
                    <span class="org-keyword">FROM</span>   peliculas
                    <span class="org-keyword">WHERE</span>  titulo <span class="org-keyword">LIKE</span> <span class="org-string">'Torrente%'</span>
                  <span class="org-rainbow-delimiters-depth-2">)</span>
         <span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-keyword">ORDER</span> <span class="org-keyword">BY</span> nombre
</pre>
</div></li>

<li><p>
Nombre de los socios que alquilaron el año pasado.
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span>   s.nombre, s.ape1
<span class="org-keyword">FROM</span>     socios s, alquiler a
<span class="org-keyword">WHERE</span>    s.c_socio = a.c_socio
  <span class="org-keyword">AND</span>    SUBSTR<span class="org-rainbow-delimiters-depth-1">(</span>a.fecha, 7, 2<span class="org-rainbow-delimiters-depth-1">)</span> = SUBSTR<span class="org-rainbow-delimiters-depth-1">(</span>SYSDATE, 7, 2<span class="org-rainbow-delimiters-depth-1">)</span> - 1
<span class="org-keyword">ORDER</span> <span class="org-keyword">BY</span> a.nombre
</pre>
</div></li>

<li><p>
Nombre de los paises que no alquilan sus peliculas.
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span>   nombre_pais
<span class="org-keyword">FROM</span>     paises
<span class="org-keyword">WHERE</span>    c_pais <span class="org-keyword">NOT</span> <span class="org-keyword">IN</span> <span class="org-rainbow-delimiters-depth-1">(</span>
           <span class="org-keyword">SELECT</span> c_pais
           <span class="org-keyword">FROM</span>   peliculas
           <span class="org-keyword">WHERE</span>  c_peli <span class="org-keyword">IN</span> <span class="org-rainbow-delimiters-depth-2">(</span>
                    <span class="org-keyword">SELECT</span> c_peli
                    <span class="org-keyword">FROM</span>   alquiler
                  <span class="org-rainbow-delimiters-depth-2">)</span>
         <span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-keyword">ORDER</span> <span class="org-keyword">BY</span> nombre_pais
</pre>
</div></li>

<li><p>
Nombre y apellidos de los socios que alquilan peliculas españolas.
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span> nombre, ape1
<span class="org-keyword">FROM</span>   socios
<span class="org-keyword">WHERE</span>  c_socio <span class="org-keyword">IN</span> <span class="org-rainbow-delimiters-depth-1">(</span>
         <span class="org-keyword">SELECT</span> c_socio
         <span class="org-keyword">FROM</span>   alquiler
         <span class="org-keyword">WHERE</span>  c_peli <span class="org-keyword">IN</span> <span class="org-rainbow-delimiters-depth-2">(</span>
                  <span class="org-keyword">SELECT</span> c_peli
                  <span class="org-keyword">FROM</span>   peliculas
                  <span class="org-keyword">WHERE</span>  c_pais = <span class="org-rainbow-delimiters-depth-3">(</span>
                           <span class="org-keyword">SELECT</span> c_pais
                           <span class="org-keyword">FROM</span>   paises
                           <span class="org-keyword">WHERE</span>  nombre_pais = <span class="org-string">'Espa&#241;a'</span>
                         <span class="org-rainbow-delimiters-depth-3">)</span>
                <span class="org-rainbow-delimiters-depth-2">)</span>
       <span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-keyword">ORDER</span> <span class="org-keyword">BY</span> nombre
</pre>
</div></li>

<li><p>
Cuantos socios han alquilado algun DVD?
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span> <span class="org-builtin">COUNT</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">DISTINCT</span> c_socio<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-keyword">FROM</span>   alquiler
<span class="org-keyword">WHERE</span>  c_peli <span class="org-keyword">IN</span> <span class="org-rainbow-delimiters-depth-1">(</span>
         <span class="org-keyword">SELECT</span> c_peli
         <span class="org-keyword">FROM</span>   peliculas
         <span class="org-keyword">WHERE</span>  formato = <span class="org-string">'DVD'</span>
       <span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div></li>

<li><p>
Cuantos paises tienen mas cines que la media de los paises?
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span> <span class="org-builtin">COUNT</span><span class="org-rainbow-delimiters-depth-1">(</span>c_pais<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-keyword">FROM</span>   paises
<span class="org-keyword">WHERE</span>  cines &gt; <span class="org-rainbow-delimiters-depth-1">(</span>
         <span class="org-keyword">SELECT</span> <span class="org-builtin">AVG</span><span class="org-rainbow-delimiters-depth-2">(</span>cines<span class="org-rainbow-delimiters-depth-2">)</span>
         <span class="org-keyword">FROM</span>   paises
       <span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div></li>

<li><p>
Nombre de los clientes que no han pedido nada.
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span> nombre
<span class="org-keyword">FROM</span>   cliente
<span class="org-keyword">WHERE</span>  idcli <span class="org-keyword">NOT</span> <span class="org-keyword">IN</span> <span class="org-rainbow-delimiters-depth-1">(</span>
         <span class="org-keyword">SELECT</span> idcli
         <span class="org-keyword">FROM</span>   pedido
       <span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div></li>

<li><p>
Cuantos pedidos se hicieron en 2017.
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span> <span class="org-builtin">COUNT</span><span class="org-rainbow-delimiters-depth-1">(</span>idped<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-keyword">FROM</span>   pedido
<span class="org-keyword">WHERE</span>  fped <span class="org-keyword">like</span> <span class="org-string">'__/__/17'</span>
</pre>
</div></li>

<li><p>
Nombre de los clientes que no son ni de Madrid ni de Toledo.
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span> nombre
<span class="org-keyword">FROM</span>   cliente
<span class="org-keyword">WHERE</span>  ciudad != <span class="org-string">'MADRID'</span>
  <span class="org-keyword">AND</span>  ciudad != <span class="org-string">'TOLEDO'</span>
</pre>
</div></li>

<li><p>
Descripcion de los articulos que se han vendido.
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span> descrip
<span class="org-keyword">FROM</span>   articulo
<span class="org-keyword">WHERE</span>  idart <span class="org-keyword">IN</span> <span class="org-rainbow-delimiters-depth-1">(</span>
         <span class="org-keyword">SELECT</span> idart
         <span class="org-keyword">FROM</span>   detalle
       <span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div></li>

<li><p>
Descripcion del articulo mas caro.
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span> descrip
<span class="org-keyword">FROM</span>   articulo
<span class="org-keyword">WHERE</span>  precio = <span class="org-rainbow-delimiters-depth-1">(</span>
         <span class="org-keyword">SELECT</span> <span class="org-builtin">MAX</span><span class="org-rainbow-delimiters-depth-2">(</span>precio<span class="org-rainbow-delimiters-depth-2">)</span>
         <span class="org-keyword">FROM</span>   articulo
       <span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div></li>

<li><p>
Cuantos pedidos nos hacen entre madrileños y toledanos?
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span> <span class="org-builtin">COUNT</span><span class="org-rainbow-delimiters-depth-1">(</span>idped<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-keyword">FROM</span>   pedido
<span class="org-keyword">WHERE</span>  idcli <span class="org-keyword">IN</span> <span class="org-rainbow-delimiters-depth-1">(</span>
         <span class="org-keyword">SELECT</span> idcli
         <span class="org-keyword">FROM</span>   cliente
         <span class="org-keyword">WHERE</span>  ciudad = <span class="org-string">'MADRID'</span>
            <span class="org-keyword">OR</span>  ciudad = <span class="org-string">'TOLEDO'</span>
       <span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div></li>

<li><p>
Cuantos pedidos se hacen en la segunda quincena del mes?
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span> <span class="org-builtin">COUNT</span><span class="org-rainbow-delimiters-depth-1">(</span>idped<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-keyword">FROM</span>   pedido
<span class="org-keyword">WHERE</span>  SUBSTR<span class="org-rainbow-delimiters-depth-1">(</span>fped, 1, 2<span class="org-rainbow-delimiters-depth-1">)</span> &gt; 15
</pre>
</div></li>

<li><p>
Listado de las ciudades con el numero de clientes que tenemos en
cada provincia.
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span>   ciudad, <span class="org-builtin">COUNT</span><span class="org-rainbow-delimiters-depth-1">(</span>idcli<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-keyword">FROM</span>     cliente
<span class="org-keyword">GROUP</span> <span class="org-keyword">BY</span> ciudad
</pre>
</div></li>

<li><p>
Listado con los nombres de los clientes junto con el numero de
pedidos que nos han hecho.
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span>   c.nombre, <span class="org-builtin">COUNT</span><span class="org-rainbow-delimiters-depth-1">(</span>p.idped<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-keyword">FROM</span>     cliente c, pedido p
<span class="org-keyword">WHERE</span>    c.idcli = p.idcli
<span class="org-keyword">GROUP</span> <span class="org-keyword">BY</span> c.nombre
</pre>
</div></li>

<li><p>
Que come Ana Kurnicova.
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span> descrip
<span class="org-keyword">FROM</span>   articulo
<span class="org-keyword">WHERE</span>  idart <span class="org-keyword">IN</span> <span class="org-rainbow-delimiters-depth-1">(</span>
         <span class="org-keyword">SELECT</span> idart
         <span class="org-keyword">FROM</span>   detalle
         <span class="org-keyword">WHERE</span>  idped <span class="org-keyword">IN</span> <span class="org-rainbow-delimiters-depth-2">(</span>
                  <span class="org-keyword">SELECT</span> idped
                  <span class="org-keyword">FROM</span>   pedido
                  <span class="org-keyword">WHERE</span>  idcli = <span class="org-rainbow-delimiters-depth-3">(</span>
                           <span class="org-keyword">SELECT</span> idcli
                           <span class="org-keyword">FROM</span>   cliente
                           <span class="org-keyword">WHERE</span>  nombre = <span class="org-string">'ANA KURNICOVA'</span>
                         <span class="org-rainbow-delimiters-depth-3">)</span>
                <span class="org-rainbow-delimiters-depth-2">)</span>
       <span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div></li>

<li><p>
Listado de los articulos que vendemos junto con la cantidad que
vendemos de ellos.
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span>   a.descrip, <span class="org-builtin">SUM</span><span class="org-rainbow-delimiters-depth-1">(</span>d.cantidad<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-keyword">FROM</span>     articulo a, detalle d
<span class="org-keyword">WHERE</span>    a.idart = d.idart
<span class="org-keyword">GROUP</span> <span class="org-keyword">BY</span> a.descrip
<span class="org-keyword">ORDER</span> <span class="org-keyword">BY</span> a.descrip
</pre>
</div></li>

<li><p>
Que capital tenemos entre corderos y hamburguesas en el almacen?
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span> <span class="org-builtin">SUM</span><span class="org-rainbow-delimiters-depth-1">(</span>stock * precio<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-keyword">FROM</span>   articulo
<span class="org-keyword">WHERE</span>  descrip <span class="org-keyword">IN</span> <span class="org-rainbow-delimiters-depth-1">(</span>
         <span class="org-string">'CORDERO'</span>,
         <span class="org-string">'HAMBURGUESA'</span>
       <span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div></li>

<li><p>
Nombre de los clientes que no comen salchichas.
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span> nombre
<span class="org-keyword">FROM</span>   cliente
<span class="org-keyword">WHERE</span>  idcli <span class="org-keyword">NOT</span> <span class="org-keyword">IN</span> <span class="org-rainbow-delimiters-depth-1">(</span>
         <span class="org-keyword">SELECT</span> idcli
         <span class="org-keyword">FROM</span>   pedido
         <span class="org-keyword">WHERE</span>  idped <span class="org-keyword">IN</span> <span class="org-rainbow-delimiters-depth-2">(</span>
                  <span class="org-keyword">SELECT</span> idped
                  <span class="org-keyword">FROM</span>   detalle
                  <span class="org-keyword">WHERE</span>  idart <span class="org-keyword">IN</span> <span class="org-rainbow-delimiters-depth-3">(</span>
                           <span class="org-keyword">SELECT</span> idart
                           <span class="org-keyword">FROM</span>   articulo
                           <span class="org-keyword">WHERE</span>  descrip = <span class="org-string">'SALCHICHAS'</span>
                         <span class="org-rainbow-delimiters-depth-3">)</span>
                <span class="org-rainbow-delimiters-depth-2">)</span>
       <span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div></li>

<li><p>
Cuantas paellas se comen en Toledo?
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span> <span class="org-builtin">SUM</span><span class="org-rainbow-delimiters-depth-1">(</span>cantidad<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-keyword">FROM</span>   detalle
<span class="org-keyword">WHERE</span>  idped <span class="org-keyword">IN</span> <span class="org-rainbow-delimiters-depth-1">(</span>
         <span class="org-keyword">SELECT</span> idped
         <span class="org-keyword">FROM</span>   pedido
         <span class="org-keyword">WHERE</span>  idcli <span class="org-keyword">IN</span> <span class="org-rainbow-delimiters-depth-2">(</span>
                  <span class="org-keyword">SELECT</span> idcli
                  <span class="org-keyword">FROM</span>   cliente
                  <span class="org-keyword">WHERE</span>  ciudad = <span class="org-string">'TOLEDO'</span>
                <span class="org-rainbow-delimiters-depth-2">)</span>
       <span class="org-rainbow-delimiters-depth-1">)</span>
  <span class="org-keyword">AND</span>  idart = <span class="org-rainbow-delimiters-depth-1">(</span>
         <span class="org-keyword">SELECT</span> idart
         <span class="org-keyword">FROM</span>   articulo
         <span class="org-keyword">WHERE</span>  descrip = <span class="org-string">'PAELLA'</span>
       <span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div></li>

<li><p>
Listado con el idped junto con el importe del pedido.
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span>   d.idped, <span class="org-builtin">SUM</span><span class="org-rainbow-delimiters-depth-1">(</span>d.cantidad * a.precio<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-keyword">FROM</span>     detalle d, articulo a
<span class="org-keyword">WHERE</span>    d.idart = a.idart
<span class="org-keyword">GROUP</span> <span class="org-keyword">BY</span> d.idped
</pre>
</div></li>

<li><p>
Listado con las ciudades y el numero de clientes de cada ciudad.
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span>   ciudad, <span class="org-builtin">COUNT</span><span class="org-rainbow-delimiters-depth-1">(</span>idcli<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-keyword">FROM</span>     cliente
<span class="org-keyword">GROUP</span> <span class="org-keyword">BY</span> ciudad
</pre>
</div></li>

<li><p>
Nombre de las ciudades en las que tenemos mas de 2 clientes.
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span>   ciudad
<span class="org-keyword">FROM</span>     cliente
<span class="org-keyword">GROUP</span> <span class="org-keyword">BY</span> ciudad
<span class="org-keyword">HAVING</span>   <span class="org-builtin">COUNT</span><span class="org-rainbow-delimiters-depth-1">(</span>idcli<span class="org-rainbow-delimiters-depth-1">)</span> &gt; 2
</pre>
</div></li>

<li><p>
En que formatos tenemos mas de 10 peliculas?
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span>   formato
<span class="org-keyword">FROM</span>     peliculas
<span class="org-keyword">GROUP</span> <span class="org-keyword">BY</span> formato
<span class="org-keyword">HAVING</span>   <span class="org-builtin">COUNT</span><span class="org-rainbow-delimiters-depth-1">(</span>c_peli<span class="org-rainbow-delimiters-depth-1">)</span> &gt; 10
</pre>
</div></li>

<li><p>
Titulo de las peliculas que hemos alquilado mas de una vez.
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span>   titulo
<span class="org-keyword">FROM</span>     peliculas
<span class="org-keyword">WHERE</span>    c_peli <span class="org-keyword">IN</span> <span class="org-rainbow-delimiters-depth-1">(</span>
           <span class="org-keyword">SELECT</span>   c_peli
           <span class="org-keyword">FROM</span>     alquiler
           <span class="org-keyword">GROUP</span> <span class="org-keyword">BY</span> c_peli
           <span class="org-keyword">HAVING</span>   <span class="org-builtin">COUNT</span><span class="org-rainbow-delimiters-depth-2">(</span>c_socio<span class="org-rainbow-delimiters-depth-2">)</span> &gt; 1
         <span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div></li>

<li><p>
Que paises producen menos de 3 peliculas?
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span>   pa.nombre_pais
<span class="org-keyword">FROM</span>     peliculas pe, paises pa
<span class="org-keyword">WHERE</span>    pe.c_pais = pa.c_pais
<span class="org-keyword">GROUP</span> <span class="org-keyword">BY</span> pa.nombre_pais
<span class="org-keyword">HAVING</span>   <span class="org-builtin">COUNT</span><span class="org-rainbow-delimiters-depth-1">(</span>pe.c_peli<span class="org-rainbow-delimiters-depth-1">)</span> &lt; 3
</pre>
</div></li>

<li><p>
Nombre de los socios que han alquilado mas de 2 peliculas.
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span>   s.nombre
<span class="org-keyword">FROM</span>     socios s, alquiler a
<span class="org-keyword">WHERE</span>    s.c_socio = a.c_socio
<span class="org-keyword">GROUP</span> <span class="org-keyword">BY</span> s.nombre
<span class="org-keyword">HAVING</span>   <span class="org-builtin">COUNT</span><span class="org-rainbow-delimiters-depth-1">(</span>a.c_peli<span class="org-rainbow-delimiters-depth-1">)</span> &gt; 2
</pre>
</div></li>
</ol>
</div>
<div id="postamble" class="status">
<p class="author">Autor: Alberto Robles Gomez</p>
<p class="date">Created: 2022-01-20 Thu 13:04</p>
</div>
</body>
</html>
